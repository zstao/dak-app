"use strict";requirejs.config({paths:{axios:"/bower_components/axios/dist/axios.amd",CONF:"/dist/scripts/config",userStore:"/dist/scripts/components/user-store",emailStore:"/dist/scripts/components/email-store",jquery:"/bower_components/jquery/dist/jquery.min",zepto:"/bower_components/zepto/zepto.min",bootstrap:"/bower_components/bootstrap/dist/js/bootstrap.min",toast:"/dist/scripts/components/toast",_:"/bower_components/lodash/lodash.min",validator:"/bower_components/validator-js/validator.min",utils:"/dist/scripts/utils/utils",simditor:"/statics/libs/simditor/dist/simditor",simditorModule:"/statics/libs/simditor/dist/module",simditorHotkeys:"/statics/libs/simditor/dist/hotkeys",simditorUploader:"/statics/libs/simditor/dist/uploader",editor:"/dist/scripts/components/editor"},shim:{bootstrap:{deps:["jquery"]}}}),requirejs(["CONF","_","jquery","validator","userStore","emailStore","axios","bootstrap","toast","editor"],function(t,o,i,e,s,a,n,r,d,l){function m(t){return k.fadeIn(200),a.getEmails(t).then(function(t){return k.fadeOut(300),t})}function c(t){var o,e=[];t=t||[],console.log(t),t.forEach(function(t){o=E(t),e.push(o),z.append(i(o))})}function p(t,o){_=t,f=o,S.html(o.topic),F.html(o.sender),I.html(o.content),N.empty(),o.tags&&o.tags.length>0&&o.tags.forEach(function(t){u(t)})}function u(t){var o=i("<div>"),e=i("<span>");o.addClass("email__tag label label-primary inline-block"),o.attr("data-tag",t),e.text(t),o.append(e),N.append(o)}var _,f,b=".",h="--active",g="tab-navs__item",v="main-body__tab",w=v+h,y=g+h,j=i(".tab-navs"),q=i(b+v),x=i(b+y),C=i(b+w),k=i(".loader-indicator"),z=i(".email-rows"),E=o.template(i("#tpl__email").html()),O=i("#modal__email-viewer"),S=i(".modal__email-topic"),F=i(".modal__email-sender"),I=i(".modal__email-content"),N=i(".email__tags-holder"),T=i(".modal__confirm-btn"),D=i(".email__handler-editor-wrapper"),H=i("#email-creator-wrapper"),M=new l("#email-editor");setTimeout(function(){i(window).resize()},20),window.editor=M,j.on("click",function(t){t.preventDefault();var o,e=i(t.target);e.is(b+y)||(e.addClass(y),x.length>0&&x.removeClass(y),C.length>0&&C.removeClass(w),x=e,o=e.index(),C=q.eq(e.index()),C.addClass(w),1===o&&H.append(i(".simditor")))}),z.on("click","tr",function(t){var o=i(t.currentTarget);k.fadeIn(200),a.getEmail(o.data("id")).then(function(t){t=t.data,p(o,t),O.modal(),D.append(i(".simditor")),k.fadeOut(200)},function(t){console.log(t)})}),m().then(function(t){c(t.data)}),T.on("click",function(){d.show("处理成功")})});