"use strict";requirejs.config({paths:{axios:"/bower_components/axios/dist/axios.amd",CONF:"/dist/scripts/config",userStore:"/dist/scripts/components/user-store",jquery:"/bower_components/jquery/dist/jquery.min",zepto:"/bower_components/zepto/zepto.min",bootstrap:"/bower_components/bootstrap/dist/js/bootstrap.min",toast:"/dist/scripts/components/toast",_:"/bower_components/lodash/lodash.min",validator:"/bower_components/validator-js/validator.min"},shim:{bootstrap:{deps:["jquery"]}}}),requirejs(["CONF","_","jquery","validator","userStore","axios","bootstrap","toast"],function(o,e,s,t,r,n,a,i){function d(o,e){var s=o.find(".form__error").eq(0);s.html(e),s.show()}function c(o){var e=o.find(".form__error").eq(0);e.hide()}function l(o){var e=s("<div>");return e.addClass("user"),e.append(s("<span>").text(o.username)),e}function u(o){var e;console.log(o);for(var s=0,t=o.length;t>s;s++)e=l(o[s]),$userViewerList.append(e)}function p(){return n.get(o.API.email.root)}var v=".",m="--active",_="tab-navs__item",f="main-body__tab",w=f+m,g=_+m,h=s(".tab-navs"),b=s(v+f),y=s(v+g),C=s(v+w),q=s(".form__mail-conf"),j=s("#email__address"),x=s("#email__password"),z=s("#email__password-confirmation"),D=s(".form__user-creation"),O=s("#user-creation__username"),k=s("#user-creation__password"),A=s("#user-creation__password-confirmation"),F=s("#user-creation__type"),I=s(".user-viewer__type-switcher"),N=(s(".user-viewer__holder"),s(".loader-indicator")),P=s(".user-viewer__type.active"),S=s(".user-viewer__list.active"),E="密码有误",L="确认密码不一致",U="用户名有误",V="请选择用户类型";h.on("click",function(o){o.preventDefault();var e,t=s(o.target);t.is(v+g)||(t.addClass(g),y.length>0&&y.removeClass(g),C.length>0&&C.removeClass(w),y=t,e=t.index(),C=b.eq(t.index()),C.addClass(w))}),q.on("submit",function(e){e.preventDefault();var s={address:j.val(),password:x.val(),passwordConfirmation:z.val()},r=t.isEmail(s.address)?void 0:L;r=r||(!s.password||s.password.length<6?E:void 0),r=r||(s.password!==s.passwordConfirmation?L:void 0),r?d(q,r):(s.id="1",n.put(o.API.email.root,s).then(function(o){console.log(o)},function(o){console.log(o)}))}),q.on("input",function(o){c(q)}),D.on("submit",function(o){o.preventDefault();var e={username:O.val(),password:k.val(),passwordConfirmation:A.val(),type:F.val()},s=!e.username||e.username.length<4?U:void 0;s=s||(!e.password||e.password.length<4?E:void 0),s=s||(e.password!==e.passwordConfirmation?L:void 0),s=s||(e.type?void 0:V),s?d(D,s):r.create(e).then(function(o){i.show("成功创建用户")},function(o){}),console.log(e)}),I.on("click",".user-viewer__type",function(o){var e=s(o.target);console.log(P),console.log(S),console.log(e)}),p().then(function(o){o=o.data,o&&o.address&&j.val(o.address)}),r.getUsers().then(function(o){N.fadeOut(500,function(){u(o.data)})},function(o){console.log(o)})});